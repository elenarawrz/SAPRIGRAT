package com.saprigrat.ui;

import com.saprigrat.data.Usuario;
import com.vaadin.annotations.AutoGenerated;
import com.vaadin.server.ThemeResource;
import com.vaadin.ui.AbsoluteLayout;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.Button.ClickListener;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.Embedded;
import com.vaadin.ui.Notification;
import com.vaadin.ui.PasswordField;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;

import elemental.events.KeyboardEvent.KeyCode;

@SuppressWarnings("serial")
public class LoginView extends CustomComponent
{

	/*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

	@AutoGenerated
	private VerticalLayout mainLayout;
	@AutoGenerated
	private VerticalLayout verticalLayout_2;
	@AutoGenerated
	private AbsoluteLayout absLCredenciales;
	@AutoGenerated
	private Button btnGo;
	@AutoGenerated
	private PasswordField txtPass;
	@AutoGenerated
	private TextField txtUser;
	@AutoGenerated
	private Embedded imgLogo;
	private Usuario usuario;
	
	public LoginView()
	{
		buildMainLayout();
		setCompositionRoot(mainLayout);
		
		usuario = new Usuario();
		
		btnGo.setClickShortcut(KeyCode.ENTER);
		btnGo.addClickListener( new ClickListener()
								{
									@Override
									public void buttonClick(ClickEvent event)
									{
										if(checkPass())
										{
											mainLayout.removeAllComponents();
											mainLayout.addComponent(new MainView(usuario));
											Notification.show("Bienvenido " + usuario.getNombre(), Notification.Type.TRAY_NOTIFICATION);
										}
										else
											Notification.show("El nombre de usuario no coincide con la contraseña.", Notification.Type.WARNING_MESSAGE);
									}
								});
	}

	private boolean checkPass()
	{
//		if(true)
//		{
//			setTipo();
//			setCURR();
//			setNombre();
//			setApP();
//			setApM();
//			setEstado();
//		}
		usuario.setTipo(1);
		usuario.setCURR("00000000000000");
		usuario.setNombre("Administrador");
		return true;
	}

	@AutoGenerated
	private VerticalLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new VerticalLayout();
		mainLayout.setImmediate(false);
		mainLayout.setWidth("-1px");
		mainLayout.setHeight("-1px");
		mainLayout.setMargin(false);
		mainLayout.setSpacing(true);
		
		// top-level component properties
		setWidth("-1px");
		setHeight("-1px");
		
		// verticalLayout_2
		verticalLayout_2 = buildVerticalLayout_2();
		mainLayout.addComponent(verticalLayout_2);
		mainLayout.setComponentAlignment(verticalLayout_2, new Alignment(20));
		
		return mainLayout;
	}

	@AutoGenerated
	private VerticalLayout buildVerticalLayout_2() {
		// common part: create layout
		verticalLayout_2 = new VerticalLayout();
		verticalLayout_2.setImmediate(false);
		verticalLayout_2.setWidth("-1px");
		verticalLayout_2.setHeight("-1px");
		verticalLayout_2.setMargin(true);
		verticalLayout_2.setSpacing(true);
		
		// imgLogo
		imgLogo = new Embedded();
		imgLogo.setImmediate(false);
		imgLogo.setWidth("350px");
		imgLogo.setHeight("80px");
		imgLogo.setSource(new ThemeResource("img/header.png"));
		imgLogo.setType(1);
		imgLogo.setMimeType("image/png");
		verticalLayout_2.addComponent(imgLogo);
		
		// absLCredenciales
		absLCredenciales = buildAbsLCredenciales();
		verticalLayout_2.addComponent(absLCredenciales);
		
		return verticalLayout_2;
	}

	@AutoGenerated
	private AbsoluteLayout buildAbsLCredenciales() {
		// common part: create layout
		absLCredenciales = new AbsoluteLayout();
		absLCredenciales.setImmediate(false);
		absLCredenciales.setWidth("350px");
		absLCredenciales.setHeight("160px");
		
		// txtUser
		txtUser = new TextField();
		txtUser.setCaption("Usuario");
		txtUser.setImmediate(false);
		txtUser.setWidth("300px");
		txtUser.setHeight("25px");
		absLCredenciales.addComponent(txtUser, "top:30.0px;left:20.0px;");
		
		// txtPass
		txtPass = new PasswordField();
		txtPass.setCaption("Contraseña");
		txtPass.setImmediate(false);
		txtPass.setWidth("300px");
		txtPass.setHeight("25px");
		absLCredenciales.addComponent(txtPass, "top:75.0px;left:20.0px;");
		
		// btnGo
		btnGo = new Button();
		btnGo.setCaption("Ingresar");
		btnGo.setImmediate(true);
		btnGo.setWidth("80px");
		btnGo.setHeight("26px");
		absLCredenciales.addComponent(btnGo, "top:125.0px;left:130.0px;");
		
		return absLCredenciales;
	}

}
