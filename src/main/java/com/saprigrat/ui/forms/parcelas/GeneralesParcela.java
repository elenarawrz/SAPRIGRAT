package com.saprigrat.ui.forms.parcelas;

import java.util.Arrays;
import java.util.LinkedList;

import org.vaadin.dialogs.ConfirmDialog;

import com.saprigrat.entities.Usuario;
import com.saprigrat.enums.TipoUsuario;
import com.saprigrat.ui.components.Foto;
import com.saprigrat.ui.interfaces.FormParcela;
import com.saprigrat.ui.interfaces.Formulario;
import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Item;
import com.vaadin.data.Property.ValueChangeEvent;
import com.vaadin.data.Property.ValueChangeListener;
import com.vaadin.event.ItemClickEvent;
import com.vaadin.event.ItemClickEvent.ItemClickListener;
import com.vaadin.event.ShortcutAction.KeyCode;
import com.vaadin.event.ShortcutAction.ModifierKey;
import com.vaadin.shared.ui.combobox.FilteringMode;
import com.vaadin.ui.AbsoluteLayout;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.Button.ClickListener;
import com.vaadin.ui.ComboBox;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.HorizontalLayout;
import com.vaadin.ui.Label;
import com.vaadin.ui.OptionGroup;
import com.vaadin.ui.Panel;
import com.vaadin.ui.Table;
import com.vaadin.ui.TextArea;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;

@SuppressWarnings("serial")
public class GeneralesParcela extends CustomComponent implements Formulario, FormParcela
{
	/*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */
	//region controles autogenerados
	
	@AutoGenerated
	private VerticalLayout mainLayout;
	@AutoGenerated
	private AbsoluteLayout absLBotones;
	@AutoGenerated
	private HorizontalLayout horLBotones;
	@AutoGenerated
	private Button btnVolver;
	@AutoGenerated
	private Button btnNuevo;
	@AutoGenerated
	private Button btnGuardar;
	@AutoGenerated
	private VerticalLayout verLDatos;
	@AutoGenerated
	private Panel panObservaciones;
	@AutoGenerated
	private AbsoluteLayout absLObservaciones;
	@AutoGenerated
	private TextArea txtObservaciones;
	@AutoGenerated
	private AbsoluteLayout absLPropiedadCoords;
	@AutoGenerated
	private Panel panCoordenadas;
	@AutoGenerated
	private VerticalLayout verLCoordenadas;
	@AutoGenerated
	private AbsoluteLayout absLCoordenadas1;
	@AutoGenerated
	private TextField txtCoordY;
	@AutoGenerated
	private TextField txtCoordX;
	@AutoGenerated
	private Panel panPropiedad;
	@AutoGenerated
	private VerticalLayout verLPropiedad;
	@AutoGenerated
	private AbsoluteLayout absLPropiedad2;
	@AutoGenerated
	private AbsoluteLayout absLPropiedadRentadaParcial;
	@AutoGenerated
	private Table tblArrendatarios;
	@AutoGenerated
	private HorizontalLayout horLBotonesArrendatarios;
	@AutoGenerated
	private Button btnCancel;
	@AutoGenerated
	private Button btnAdd;
	@AutoGenerated
	private AbsoluteLayout absLPropiedadRentada;
	@AutoGenerated
	private TextField txtSuperficieArrendada;
	@AutoGenerated
	private Label lblSuperficieArrendada;
	@AutoGenerated
	private TextField txtArrendatario;
	@AutoGenerated
	private AbsoluteLayout absLPropiedad1;
	@AutoGenerated
	private ComboBox cmbPropiedad;
	@AutoGenerated
	private Panel panDetTecnicos;
	@AutoGenerated
	private VerticalLayout verLDetTecnicos;
	@AutoGenerated
	private AbsoluteLayout absLDetTecnicosDistrito;
	@AutoGenerated
	private ComboBox cmbSRL;
	@AutoGenerated
	private ComboBox cmbModuloR;
	@AutoGenerated
	private ComboBox cmbDtoR;
	@AutoGenerated
	private AbsoluteLayout absLDetTecnicosUnidad;
	@AutoGenerated
	private TextField txtUdeRiego;
	@AutoGenerated
	private AbsoluteLayout absLDetTecnicos;
	@AutoGenerated
	private OptionGroup optUnidadoDto;
	@AutoGenerated
	private ComboBox cmbOrgCuenca;
	@AutoGenerated
	private AbsoluteLayout absLGeneralesFoto;
	@AutoGenerated
	private Foto panFoto;
	@AutoGenerated
	private Panel panGenerales;
	@AutoGenerated
	private AbsoluteLayout absLGenerales;
	@AutoGenerated
	private ComboBox cmbTenencia;
	@AutoGenerated
	private ComboBox cmbFAbast;
	@AutoGenerated
	private Label lblSuperficie;
	@AutoGenerated
	private TextField txtSuperficie;
	@AutoGenerated
	private TextField txtNoLote;
	@AutoGenerated
	private TextField txtNoSubctaPadron;
	@AutoGenerated
	private TextField txtNoCtaPadron;
	@AutoGenerated
	private VerticalLayout verLListado;
	@AutoGenerated
	private Label lblRowCount;
	@AutoGenerated
	private Table tblListado;
	@AutoGenerated
	private HorizontalLayout horLRespProd;
	@AutoGenerated
	private Panel panProductor;
	@AutoGenerated
	private AbsoluteLayout absLProductor;
	@AutoGenerated
	private ComboBox cmbProductor;
	@AutoGenerated
	private Panel panResponsable;
	@AutoGenerated
	private AbsoluteLayout absLResponsable;
	@AutoGenerated
	private ComboBox cmbResponsable;
	
	//endregion
	private Usuario usuario;
	private int idGeneralesParcela;
	private LinkedList<String> propiedadList;
	LinkedList<LinkedList<Object>> listaArrendatarios;
	private int arrendatarioSel;
	private TextField txtParcela;
	
	//region eventos
	private ClickListener guardarListener = new ClickListener()
			{
				@Override
				public void buttonClick(ClickEvent event)
				{
					if(validar())
					{
						LinkedList<Object> valores = llenarListaDeParametros();
						if(btnGuardar.getCaption().equals("Guardar"))
						{
							String status = datos.registrarParcela(valores);
							if(!status.isEmpty() && status.indexOf("err") == -1)
							{
								u.msjGuardado("La parcela", "");
								//Se cambia a modo de modificación
								setTipo(MODO_MODIFICAR);
								idGeneralesParcela = Integer.parseInt(status);
								setNumCta();
							}
							else
								if(status.indexOf("Rep") != -1)
									u.msjNoGuardadoRepetido("número de padrón");
								else
									u.msjNoGuardado("los datos generales de la parcela");
						}
						else
						{
							valores.add(0, idGeneralesParcela);
							
							String status = datos.modificarParcela(valores);
							if(!status.isEmpty() && status.indexOf("err") == -1)
							{
								u.msjModificado("La parcela");
								setNumCta();
							}
							else
								if(status.indexOf("Rep") != -1)
									u.msjNoModificadoRepetido("número de padrón");
								else
									u.msjNoModificado("los datos generales de la parcela");
						}
					}
				}
				
				private void setNumCta()
				{
					txtParcela.setValue(txtNoCtaPadron.getValue() + " / " + txtNoSubctaPadron.getValue());
				}
			};
	private ItemClickListener llenarFormListener = new ItemClickListener()
			{
				@Override
				public void itemClick(ItemClickEvent event)
				{
					if(event.isDoubleClick())
					{
						idGeneralesParcela = (Integer)event.getItem().getItemProperty("ID").getValue();
						llenarFormulario();
					}
				}
			};
	private ValueChangeListener llenarTablaOProductoresListener = new ValueChangeListener()
			{
				@Override
				public void valueChange(ValueChangeEvent event)
				{
					String curr = ((String)cmbResponsable.getValue()).split(" ")[0];
					if(verLListado.isVisible())
						u.llenarTabla(tblListado, datos.getParcelas(curr), "registro de parcela");
					else
					{
						u.llenarCombo(cmbProductor, datos.getRespProductores(curr));
						if(cmbProductor.size() == 0)
							u.notificar("No se podrá agregar el registro ya que este técnico no tiene asignado a ningún productor.", null, u.MSJ_ADVERTENCIA);
					}
				}
			};
	private ClickListener nuevoListener = new ClickListener()
			{
				@Override
				public void buttonClick(ClickEvent event)
				{
					if(!verLListado.isVisible())
						showDialog(MODO_AGREGAR);
					else
						resetForm(MODO_AGREGAR);
				}
			};
	private ClickListener listadoListener = new ClickListener()
			{
				@Override
				public void buttonClick(ClickEvent event)
				{
					showDialog(MODO_LISTA);
				}
			};
	private ValueChangeListener cambioDeDtoListener = new ValueChangeListener()
			{
				@Override
				public void valueChange(ValueChangeEvent event)
				{
					cmbModuloR.addItem("No Aplica");
					cmbSRL.addItem("No Aplica");
					u.llenarCombo(cmbModuloR, datos.getModRiego((String)cmbDtoR.getValue()));
					u.llenarCombo(cmbSRL, datos.getSRL((String)cmbDtoR.getValue()));
				}
			};
	private ValueChangeListener mostrarListasListener = new ValueChangeListener()
			{
				@Override
				public void valueChange(ValueChangeEvent event)
				{
					boolean isUR = optUnidadoDto.getValue().equals("Unidad de Riego");
					absLDetTecnicosUnidad.setVisible(isUR);
					absLDetTecnicosDistrito.setVisible(!isUR);
				}
			};
	private ValueChangeListener mostrarArrendatariosListener = new ValueChangeListener()
			{
				@Override
				public void valueChange(ValueChangeEvent event)
				{
					switch(getPropiedadIndex())
					{
						case 0: tipoPropiedad(false, false); break;
						case 1: tipoPropiedad(true, false); break;
						case 2: tipoPropiedad(false, true); break;
					}
				}
			};
	private ClickListener agregarModificarArrendatarioListener = new ClickListener()
			{
				@Override
				public void buttonClick(ClickEvent event)
				{
					if(absLPropiedadRentada.isVisible())
					{
						if(validarArrendatario())
						{
							if(btnAdd.getCaption().equals("Agregar"))
								listaArrendatarios.add(getRow());
							else
								listaArrendatarios.set(arrendatarioSel, getRow());
							recargarListaArrendatario();
							ocultarFormArrendatario();
						}
					}
					else
						mostrarFormArrendatario();
				}
				
				private boolean validarArrendatario()
				{
//					if(txtSuperficie.getValue().isEmpty() || !txtSuperficie.isValid())
//						return u.notificar("Se requiere especificar la superficie total para poder agregar arrendatarios", txtSuperficie, u.MSJ_ERROR);
					if(txtArrendatario.getValue().isEmpty())
						return u.notificar("Se requiere especificar el nombre del arrendatario", txtArrendatario, u.MSJ_ERROR);
					if(txtSuperficieArrendada.getValue().isEmpty() || !txtSuperficieArrendada.isValid())
						return u.notificar("Se requiere especificar un valor numérico para la superficie arrendada", txtSuperficieArrendada, u.MSJ_ERROR);
					else
						if(Double.parseDouble(txtSuperficieArrendada.getValue()) == 0)
							return u.notificar("La superficie arrendada no puede ser igual a 0", txtSuperficieArrendada, u.MSJ_ERROR);
					
//					Double sumaSup = Double.parseDouble(txtSuperficieArrendada.getValue()) -
//									 (arrendatarioSel != -1 ? (Double)listaArrendatarios.get(arrendatarioSel).getLast() : 0);
//					for(LinkedList<Object> arrendatario : listaArrendatarios)
//						sumaSup += (Double)arrendatario.getLast();
//					if(sumaSup > Double.parseDouble(txtSuperficie.getValue()))
//						return u.notificar("Está excediendo la superficie total definida en la sección de datos generales", txtSuperficieArrendada, u.MSJ_ERROR);
					
					return true;
				}
			};
	private ClickListener cancelarEliminarArrendatarioListener = new ClickListener()
			{
				@Override
				public void buttonClick(ClickEvent event)
				{
					if(btnCancel.getCaption().equals("Cancelar"))
						ocultarFormArrendatario();
					else
					{
						if(tblArrendatarios.getValue() != null)
						{
							ConfirmDialog.show( event.getButton().getUI(),
												"Atención:",
												"Está a punto de eliminar un arrendatario y esta acción no se puede deshacer." +
												"\n¿Desea continuar?", "Si", "No",
												new ConfirmDialog.Listener()
												{
													public void onClose(ConfirmDialog dialog)
													{
														if (dialog.isConfirmed())
														{
															int rowId = (Integer)tblArrendatarios.getValue();
															rowId = (Integer)tblArrendatarios.getContainerProperty(rowId,"Núm.").getValue();
															listaArrendatarios.remove(rowId - 1);
															recargarListaArrendatario();
														}
													}
												});
						}
						else
							u.notificar("No ha seleccionado ningún arrendatario a eliminar", null, u.MSJ_ADVERTENCIA);
					}
				}
			};
	private ItemClickListener cargarArrendatarioListener = new ItemClickListener()
			{
				@Override
				public void itemClick(ItemClickEvent event)
				{
					if(event.isDoubleClick())
					{
						Item item = event.getItem();
						arrendatarioSel = (Integer)item.getItemProperty("Núm.").getValue() - 1;
						txtArrendatario.setValue(item.getItemProperty("Nombre del Arrendatario").getValue() + "");
						txtSuperficieArrendada.setValue(item.getItemProperty("Superficie (ha)").getValue() + "");
						
						mostrarFormArrendatario();
						btnAdd.setCaption("Modificar");
					}
				}
			};
	private ValueChangeListener actualizarSuperficieListener = new ValueChangeListener()
			{
				@Override
				public void valueChange(ValueChangeEvent event)
				{
					if(getPropiedadIndex() == 1)
						txtSuperficieArrendada.setValue(txtSuperficie.isValid() ? txtSuperficie.getValue() : "");
				}
			};
	//endregion
	
	public GeneralesParcela(){}
	public GeneralesParcela(Usuario user) { init(user); }
	
	@Override
	public void init(Usuario user)
	{
		usuario = user;
		propiedadList = datos.getPropiedadParcela();
	}

	@Override
	public void inicializar()
	{
		buildMainLayout();
		setCompositionRoot(mainLayout);
		
		//Variables
		listaArrendatarios = new LinkedList<LinkedList<Object>>();
		arrendatarioSel = -1;
		//Textfields
		txtSuperficie.addValueChangeListener(actualizarSuperficieListener);
		//Comboboxes
		u.setupCombo(cmbResponsable, null, "Busque por nombre o CURR.", FilteringMode.CONTAINS, false, true);
		u.setupCombo(cmbProductor, null, "Busque por nombre o CURR.", FilteringMode.CONTAINS, false, true);
		u.setupCombo(cmbFAbast, datos.getAbastecimiento(), null, null, false, false);
		u.setupCombo(cmbTenencia, datos.getTenencia(), null, null, false, false);
		u.setupCombo(cmbOrgCuenca, datos.getOrgCuenca(), null, FilteringMode.CONTAINS, false, true);
		u.setupCombo(cmbDtoR, datos.getDtoRiego(), null, null, true, true);
		u.setupCombo(cmbPropiedad, propiedadList, null, null, false, false);
		cmbResponsable.addValueChangeListener(llenarTablaOProductoresListener);
		cmbDtoR.addValueChangeListener(cambioDeDtoListener);
		cmbModuloR.setFilteringMode(FilteringMode.CONTAINS);
		cmbSRL.setFilteringMode(FilteringMode.CONTAINS);
		cmbPropiedad.addValueChangeListener(mostrarArrendatariosListener);
		cmbPropiedad.setValue(propiedadList.get(0));
		//Optionbuttons
		optUnidadoDto.addItem("Unidad de Riego");
		optUnidadoDto.addItem("Distrito de Riego");
		optUnidadoDto.addValueChangeListener(mostrarListasListener);
		//Tables
		tblListado.setSelectable(true);
		tblListado.setSortEnabled(true);
		tblListado.setColumnCollapsingAllowed(true);
		tblListado.addItemClickListener(llenarFormListener);
		tblArrendatarios.addContainerProperty("Núm.", Object.class, null);
		tblArrendatarios.addContainerProperty("Nombre del Arrendatario", Object.class, null);
		tblArrendatarios.addContainerProperty("Superficie (ha)", Object.class, null);
		tblArrendatarios.setSelectable(true);
		tblArrendatarios.setSortEnabled(true);
		tblArrendatarios.addItemClickListener(cargarArrendatarioListener);
		//Buttons
		btnAdd.addClickListener(agregarModificarArrendatarioListener);
		btnCancel.addClickListener(cancelarEliminarArrendatarioListener);
		btnNuevo.addClickListener(nuevoListener);
		btnVolver.addClickListener(listadoListener);
		btnGuardar.addClickListener(guardarListener);
		//Layouts
		absLDetTecnicosUnidad.setVisible(false);
		absLDetTecnicosDistrito.setVisible(false);
		//Inicializar en modo lista
		//setTipo(MODO_LISTA);
		//Agregar las validaciones necesarias
		setValidaciones();

//		cmbOrgCuenca.addValueChangeListener(cambioDeOrgListener);
//		private ValueChangeListener cambioDeOrgListener =   new ValueChangeListener()
//		{
//			@Override
//			public void valueChange(ValueChangeEvent event)
//			{
//				llenarLista(datos.getDtoRiego((String)cmbOrgCuenca.getValue()), cmbDtoR);
//			}
//		};
	}

	@Override
	public void setTipo(int modoOperacion)
	{
		btnNuevo.setClickShortcut(KeyCode.N, ModifierKey.ALT);
		if(modoOperacion == MODO_LISTA)
		{
			setResponsableTecnico(usuario.getTipo());
			mostrarTabla(true);
			btnGuardar.removeClickShortcut();
			btnGuardar.setVisible(false);
			btnVolver.removeClickShortcut();
			btnVolver.setVisible(false);
			btnNuevo.setCaption("Agregar Nuevo");
		}
		else
		{
			mostrarTabla(false);
			btnGuardar.setClickShortcut(KeyCode.G, ModifierKey.ALT);
			btnGuardar.setVisible(true);
			btnVolver.setClickShortcut(KeyCode.V, ModifierKey.ALT);
			btnVolver.setVisible(true);
			
			if(modoOperacion == MODO_AGREGAR)
			{
				btnGuardar.setCaption("Guardar");
				btnNuevo.setClickShortcut(KeyCode.L, ModifierKey.ALT);
				btnNuevo.setCaption("Limpiar");
			}
			else
			{
				btnGuardar.setCaption("Guardar cambios");
				btnNuevo.setCaption("Agregar Nuevo");
			}
		}
	}
	
	@Override
	public void quitarListeners ()
	{
		cmbResponsable.removeValueChangeListener(llenarTablaOProductoresListener);
		
		horLRespProd.setVisible(false);
		horLBotones.setVisible(false);
	}
	
	public void setTxtParcela(TextField txt)
	{
		txtParcela = txt;
	}

	@Override
	public void setParcela (int idParcela, String padron)
	{
		idGeneralesParcela = idParcela;
		if(idGeneralesParcela > 0)
			llenarFormulario();
		else
			setTipo(MODO_AGREGAR);
	}

	@Override
	public void setResponsable (String responsable)
	{
		u.llenarCombo(cmbResponsable, responsable);
	}

	@Override
	public void setProductor (String productor)
	{
		u.llenarCombo(cmbProductor, productor);
	}

	private void setResponsableTecnico(int tipoAgregando)
	{
		if(tipoAgregando != usuario.RESPONSABLE)
			u.llenarCombo(cmbResponsable, datos.getRespTecnicos(usuario.getCURR(), tipoAgregando, usuario.RESPONSABLE));
		else
			u.llenarCombo(cmbResponsable, usuario.getCURR() + " " + usuario.getNombre() + " " +
								  		  usuario.getApPaterno() + " " + usuario.getApMaterno());
		if(cmbResponsable.size() == 0)
		{
			mainLayout.removeAllComponents();
			u.notificar("Imposible registrar parcela, se requiere que exista al menos un " + TipoUsuario.PRODUCTOR + " a quien pueda ser asignada", null, u.MSJ_ERROR);
		}
	}
	
	private void mostrarTabla(boolean estado)
	{
		panProductor.setVisible(!estado);
		verLListado.setVisible(estado);
		verLDatos.setVisible(!estado);
	}
	
	private void setValidaciones()
	{
		txtSuperficie.addValidator(u.getRegExDecimal());
		txtSuperficieArrendada.addValidator(u.getRegExDecimal());
	}

	private boolean validar()
	{
		if(cmbResponsable.getValue() == null)
			return u.notificar("Se requiere especificar el responsable técnico", cmbResponsable, u.MSJ_ERROR);
		if(cmbProductor.getValue() == null)
			return u.notificar("Se requiere especificar el usuario", cmbProductor, u.MSJ_ERROR);
		if(txtNoCtaPadron.getValue().isEmpty())
			return u.notificar("Se requiere especificar el número de cuenta del padrón", txtNoCtaPadron, u.MSJ_ERROR);
		if(txtNoLote.getValue().isEmpty())
			return u.notificar("Se requiere especificar el número de lote", txtNoLote, u.MSJ_ERROR);
		if(txtSuperficie.getValue().isEmpty())
			return u.notificar("Se requiere especificar la superficie en hectáreas", txtSuperficie, u.MSJ_ERROR);
		if(cmbFAbast.getValue() == null)
			return u.notificar("Se requiere especificar la fuente de abastecimiento", cmbFAbast, u.MSJ_ERROR);
		if(cmbOrgCuenca.getValue() == null)
			return u.notificar("Se requiere especificar el organismo de cuenca", cmbOrgCuenca, u.MSJ_ERROR);
		if(optUnidadoDto.getValue() == null)
			return u.notificar("Se requiere especificar si pertenece a unidad o distrito de riego", optUnidadoDto, u.MSJ_ERROR);
		else
			if(optUnidadoDto.getValue().equals("Unidad de Riego") && txtUdeRiego.getValue().isEmpty())
				return u.notificar("Se requiere especificar la unidad de riego", txtUdeRiego, u.MSJ_ERROR);
			else
				if(optUnidadoDto.getValue().equals("Distrito de Riego") && cmbDtoR.getValue() == null)
					return u.notificar("Se requiere especificar el distrito de riego", cmbDtoR, u.MSJ_ERROR);
		if(cmbPropiedad.getValue() != null)
		{
			if(getPropiedadIndex() == 1 && txtArrendatario.getValue().isEmpty())
				return u.notificar("Se requiere especificar el nombre del arrendatario", txtArrendatario, u.MSJ_ERROR);
			if(getPropiedadIndex() == 2 && listaArrendatarios.size() == 0)
				return u.notificar("Se requiere especificar por lo menos un arrendatario", tblArrendatarios, u.MSJ_ERROR);
		}
		else
			return u.notificar("Se requiere especificar la propiedad de la parcela", cmbPropiedad, u.MSJ_ERROR);
		
		if(!txtSuperficie.isValid())
			return u.notificar("La superficie debe ser estríctamente numérica", txtSuperficie, u.MSJ_ERROR);
		
		return true;
	}
	
	private LinkedList<Object> llenarListaDeParametros()
	{
		LinkedList<Object> valores = new LinkedList<Object>();
		valores.add(((String)cmbProductor.getValue()).split(" ")[0]);
		valores.add(txtNoCtaPadron.getValue());
		valores.add(txtNoSubctaPadron.getValue());
		valores.add(txtNoLote.getValue());
		valores.add(u.stringToDouble(txtSuperficie.getValue()));
		valores.add(cmbFAbast.getValue());
		valores.add(cmbTenencia.getValue());
		valores.add(cmbOrgCuenca.getValue());
		if(optUnidadoDto.getValue().equals("Unidad de Riego"))
		{
			valores.add(txtUdeRiego.getValue());
			valores.add("");
			valores.add("");
			valores.add("");
		}
		else
		{
			valores.add("");
			valores.add(cmbDtoR.getValue());
			valores.add(cmbSRL.getValue());
			valores.add(cmbModuloR.getValue());
		}
		valores.add(cmbPropiedad.getValue());
		
		LinkedList<Object> arrs = getArreglosArrendatario();
		valores.add((String[]) arrs.pop());
		valores.add((Double[]) arrs.pop());
		valores.add(((Double[])valores.peekLast()).length);
		
		valores.add(txtCoordX.getValue());
		valores.add(txtCoordY.getValue());
		valores.add(txtObservaciones.getValue());
		valores.add(panFoto.getFoto());
		
		return valores;
	}
	
	private LinkedList<Object> getArreglosArrendatario()
	{
		int index = getPropiedadIndex();
		int rows = index > 1 ? listaArrendatarios.size() : 1;
		String[] arrNombre = new String[rows];
		Double[] arrSuperficie = new Double[rows];
		
		if(index > 0)
		{
			if(index == 1)
			{
				arrNombre[0] = txtArrendatario.getValue();
				arrSuperficie[0] = u.stringToDouble(txtSuperficieArrendada.getValue());
			}
			else
			{
				for(int i = 0; i < rows; i++)
				{
					LinkedList<Object> arrendatario = new LinkedList<Object>();
					arrendatario.addAll(listaArrendatarios.get(i));
					arrendatario.remove();
					
					arrNombre[i] = (String) arrendatario.pop();
					arrSuperficie[i] = (Double) arrendatario.pop();
				}
			}
		}
		
		LinkedList<Object> arreglos = new LinkedList<Object>();
		arreglos.add(arrNombre);
		arreglos.add(arrSuperficie);
		
		return arreglos;
	}
	
	private void llenarFormulario ()
	{
		LinkedList<Object> valores = datos.getParcela(idGeneralesParcela);
		if(!valores.isEmpty())
		{
			setTipo(MODO_MODIFICAR);
			
			u.llenarCombo(cmbProductor, datos.getRespProductores(((String)cmbResponsable.getValue()).split(" ")[0]));
			cmbProductor.select(valores.remove());
			llenarDatos (valores);
			
			if(getPropiedadIndex() > 0)
				setupListaArrendatarios(datos.getListaArrendatarios(idGeneralesParcela));
			optUnidadoDto.select(txtUdeRiego.getValue().isEmpty() ? "Distrito de Riego"
																  : "Unidad de Riego");
		}
		else
			u.msjRegistroNoObtenido();
	}
	
	public void setupNuevo()
	{
		Object[] arr = { "", "", "", "", null,
						 null, null, "", null, null,
						 null, null, "", "", "",
						 "" };
		llenarDatos (new LinkedList<Object>(Arrays.asList(arr)));
		setTipo(MODO_AGREGAR);
	}
	
	private void llenarDatos (LinkedList<Object> valores)
	{
		txtNoCtaPadron.setValue((String)valores.remove());
		txtNoSubctaPadron.setValue((String)valores.remove());
		txtNoLote.setValue((String)valores.remove());
		txtSuperficie.setValue(u.doubleToString(valores.remove()));
		cmbFAbast.select(valores.remove());
		cmbTenencia.select(valores.remove());
		cmbOrgCuenca.select(valores.remove());
		txtUdeRiego.setValue((String)valores.remove());
		cmbDtoR.select(valores.remove());
		cmbSRL.select(valores.remove());
		cmbModuloR.select(valores.remove());
		cmbPropiedad.select(valores.remove());
		txtCoordX.setValue((String)valores.remove());
		txtCoordY.setValue((String)valores.remove());
		txtObservaciones.setValue((String)valores.remove());
		panFoto.setFoto((String)valores.remove());
	}
	
	private void setupListaArrendatarios(LinkedList<Object[]> listaArrendatariosBD)
	{
		if(getPropiedadIndex() == 1 && listaArrendatariosBD.size() > 0)
		{
			Object[] arrendatario = listaArrendatariosBD.pop();
			txtArrendatario.setValue((String)arrendatario[0]);
			txtSuperficieArrendada.setValue(u.doubleToString(arrendatario[1]));
		}
		else
		{
			listaArrendatarios.clear();
			for(Object[] arrendatario : listaArrendatariosBD)
			{
				LinkedList<Object> row = new LinkedList<Object>();
				row.add(0);
				for(Object valor : arrendatario)
					row.add(valor);
				listaArrendatarios.add(row);
			}
			recargarListaArrendatario();
		}
	}
	
	private void showDialog(final int modo)
	{
		ConfirmDialog.show( this.getUI(),
							"Advertencia:",
							"Perderá todos los cambios realizados hasta el momento.\n¿Desea continuar?",
							"Si", "No",
							new ConfirmDialog.Listener()
							{
								public void onClose(ConfirmDialog dialog)
								{
									if (dialog.isConfirmed())
										resetForm(modo);
								}
							});
	}
	
	private void resetForm(int modo)
	{
		Object respSelected = cmbResponsable.getValue();
		inicializar();
		setTipo(modo);
		cmbResponsable.setValue(respSelected);
	}
	
	private int getPropiedadIndex()
	{
		return propiedadList.indexOf(cmbPropiedad.getValue());
	}
	
	private void tipoPropiedad(boolean esRentadaCompleta, boolean esRentadaParcial)
	{
		absLPropiedadRentada.setVisible(esRentadaCompleta);
		absLPropiedadRentadaParcial.setVisible(esRentadaParcial);
		
		txtSuperficieArrendada.setEnabled(esRentadaParcial);
		txtSuperficieArrendada.setValue(esRentadaCompleta && txtSuperficie.isValid() ? txtSuperficie.getValue() : "");
		
		if(esRentadaParcial)
			ocultarFormArrendatario();
		else
		{
			absLPropiedadCoords.setHeight("131px");
			btnAdd.removeClickShortcut();
			btnCancel.removeClickShortcut();
		}
	}
	
	private void mostrarFormArrendatario()
	{
		btnCancel.setCaption("Cancelar");
		btnCancel.setClickShortcut(KeyCode.C, ModifierKey.ALT);
		absLPropiedadRentada.setVisible(true);
		absLPropiedadCoords.setHeight("324px");
		txtArrendatario.focus();
	}
	
	private void ocultarFormArrendatario()
	{
		arrendatarioSel = -1;
		txtArrendatario.setValue("");
		txtSuperficieArrendada.setValue("");

		btnAdd.setCaption("Agregar");
		btnAdd.setClickShortcut(KeyCode.A, ModifierKey.ALT);
		btnCancel.setCaption("Eliminar");
		btnCancel.setClickShortcut(KeyCode.E, ModifierKey.ALT);
		absLPropiedadRentada.setVisible(false);
		absLPropiedadCoords.setHeight("279px");
	}
	
	private LinkedList<Object> getRow()
	{
		LinkedList<Object> arrendatario = new LinkedList<Object>();
		arrendatario.add(0);
		arrendatario.add(txtArrendatario.getValue());
		arrendatario.add(u.stringToDouble(txtSuperficieArrendada.getValue()));
		return arrendatario;
	}
	
	private void recargarListaArrendatario()
	{
		tblArrendatarios.removeAllItems();
		double suma = 0;
		for(int i = 0; i < listaArrendatarios.size(); i++)
		{
			LinkedList<Object> arrendatario = listaArrendatarios.get(i);
			arrendatario.set(0, i + 1);
			tblArrendatarios.addItem(arrendatario.toArray(), null);
			suma += (Double)arrendatario.getLast();
		}
		txtSuperficie.setValue(String.valueOf(suma));
	}
	//region UI
	
	@AutoGenerated
	private VerticalLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new VerticalLayout();
		mainLayout.setImmediate(false);
		mainLayout.setWidth("-1px");
		mainLayout.setHeight("-1px");
		mainLayout.setMargin(true);
		mainLayout.setSpacing(true);
		
		// top-level component properties
		setWidth("-1px");
		setHeight("-1px");
		
		// horLRespProd
		horLRespProd = buildHorLRespProd();
		mainLayout.addComponent(horLRespProd);
		
		// verLListado
		verLListado = buildVerLListado();
		mainLayout.addComponent(verLListado);
		
		// verLDatos
		verLDatos = buildVerLDatos();
		mainLayout.addComponent(verLDatos);
		
		// absLBotones
		absLBotones = buildAbsLBotones();
		mainLayout.addComponent(absLBotones);
		mainLayout.setComponentAlignment(absLBotones, new Alignment(24));
		
		return mainLayout;
	}
	@AutoGenerated
	private HorizontalLayout buildHorLRespProd() {
		// common part: create layout
		horLRespProd = new HorizontalLayout();
		horLRespProd.setImmediate(false);
		horLRespProd.setWidth("801px");
		horLRespProd.setHeight("-1px");
		horLRespProd.setMargin(false);
		
		// panResponsable
		panResponsable = buildPanResponsable();
		horLRespProd.addComponent(panResponsable);
		
		// panProductor
		panProductor = buildPanProductor();
		horLRespProd.addComponent(panProductor);
		horLRespProd.setComponentAlignment(panProductor, new Alignment(6));
		
		return horLRespProd;
	}
	@AutoGenerated
	private Panel buildPanResponsable() {
		// common part: create layout
		panResponsable = new Panel();
		panResponsable.setCaption("Responsable Técnico");
		panResponsable.setImmediate(false);
		panResponsable.setWidth("396px");
		panResponsable.setHeight("-1px");
		
		// absLResponsable
		absLResponsable = buildAbsLResponsable();
		panResponsable.setContent(absLResponsable);
		
		return panResponsable;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLResponsable() {
		// common part: create layout
		absLResponsable = new AbsoluteLayout();
		absLResponsable.setImmediate(false);
		absLResponsable.setWidth("100.0%");
		absLResponsable.setHeight("45px");
		
		// cmbResponsable
		cmbResponsable = new ComboBox();
		cmbResponsable.setImmediate(true);
		cmbResponsable.setWidth("375px");
		cmbResponsable.setHeight("25px");
		absLResponsable.addComponent(cmbResponsable, "top:10.0px;left:10.0px;");
		
		return absLResponsable;
	}
	@AutoGenerated
	private Panel buildPanProductor() {
		// common part: create layout
		panProductor = new Panel();
		panProductor.setCaption("Usuario");
		panProductor.setImmediate(false);
		panProductor.setWidth("396px");
		panProductor.setHeight("-1px");
		
		// absLProductor
		absLProductor = buildAbsLProductor();
		panProductor.setContent(absLProductor);
		
		return panProductor;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLProductor() {
		// common part: create layout
		absLProductor = new AbsoluteLayout();
		absLProductor.setImmediate(false);
		absLProductor.setWidth("100.0%");
		absLProductor.setHeight("45px");
		
		// cmbProductor
		cmbProductor = new ComboBox();
		cmbProductor.setImmediate(false);
		cmbProductor.setWidth("375px");
		cmbProductor.setHeight("25px");
		absLProductor.addComponent(cmbProductor, "top:10.0px;left:10.0px;");
		
		return absLProductor;
	}
	@AutoGenerated
	private VerticalLayout buildVerLListado() {
		// common part: create layout
		verLListado = new VerticalLayout();
		verLListado.setImmediate(false);
		verLListado.setWidth("-1px");
		verLListado.setHeight("-1px");
		verLListado.setMargin(false);
		
		// tblListado
		tblListado = new Table();
		tblListado
				.setCaption("* Dar doble click sobre un elemento para modificarlo");
		tblListado.setImmediate(false);
		tblListado.setWidth("801px");
		tblListado.setHeight("300px");
		verLListado.addComponent(tblListado);
		
		// lblRowCount
		lblRowCount = new Label();
		lblRowCount.setImmediate(false);
		lblRowCount.setWidth("-1px");
		lblRowCount.setHeight("-1px");
		lblRowCount.setValue("0 registros encontrados");
		verLListado.addComponent(lblRowCount);
		
		return verLListado;
	}
	@AutoGenerated
	private VerticalLayout buildVerLDatos() {
		// common part: create layout
		verLDatos = new VerticalLayout();
		verLDatos.setImmediate(false);
		verLDatos.setWidth("-1px");
		verLDatos.setHeight("-1px");
		verLDatos.setMargin(false);
		verLDatos.setSpacing(true);
		
		// absLGeneralesFoto
		absLGeneralesFoto = buildAbsLGeneralesFoto();
		verLDatos.addComponent(absLGeneralesFoto);
		
		// panDetTecnicos
		panDetTecnicos = buildPanDetTecnicos();
		verLDatos.addComponent(panDetTecnicos);
		
		// absLPropiedadCoords
		absLPropiedadCoords = buildAbsLPropiedadCoords();
		verLDatos.addComponent(absLPropiedadCoords);
		
		// panObservaciones
		panObservaciones = buildPanObservaciones();
		verLDatos.addComponent(panObservaciones);
		
		return verLDatos;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLGeneralesFoto() {
		// common part: create layout
		absLGeneralesFoto = new AbsoluteLayout();
		absLGeneralesFoto.setImmediate(false);
		absLGeneralesFoto.setWidth("100.0%");
		absLGeneralesFoto.setHeight("221px");
		
		// panGenerales
		panGenerales = buildPanGenerales();
		absLGeneralesFoto.addComponent(panGenerales, "top:0.0px;left:0.0px;");
		
		// panFoto
		panFoto = new Foto();
		panFoto.setImmediate(false);
		panFoto.setWidth("-1px");
		panFoto.setHeight("-1px");
		absLGeneralesFoto.addComponent(panFoto, "top:0.0px;right:0.0px;");
		
		return absLGeneralesFoto;
	}
	@AutoGenerated
	private Panel buildPanGenerales() {
		// common part: create layout
		panGenerales = new Panel();
		panGenerales.setCaption("Datos Generales");
		panGenerales.setImmediate(false);
		panGenerales.setWidth("321px");
		panGenerales.setHeight("-1px");
		
		// absLGenerales
		absLGenerales = buildAbsLGenerales();
		panGenerales.setContent(absLGenerales);
		
		return panGenerales;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLGenerales() {
		// common part: create layout
		absLGenerales = new AbsoluteLayout();
		absLGenerales.setImmediate(false);
		absLGenerales.setWidth("100.0%");
		absLGenerales.setHeight("200px");
		
		// txtNoCtaPadron
		txtNoCtaPadron = new TextField();
		txtNoCtaPadron.setCaption("Núm. de Cta. del Padrón");
		txtNoCtaPadron.setImmediate(false);
		txtNoCtaPadron.setWidth("170px");
		txtNoCtaPadron.setHeight("25px");
		absLGenerales.addComponent(txtNoCtaPadron, "top:28.0px;left:10.0px;");
		
		// txtNoSubctaPadron
		txtNoSubctaPadron = new TextField();
		txtNoSubctaPadron.setCaption("Núm. de Subcta.");
		txtNoSubctaPadron.setImmediate(false);
		txtNoSubctaPadron.setWidth("110px");
		txtNoSubctaPadron.setHeight("25px");
		absLGenerales.addComponent(txtNoSubctaPadron,
				"top:28.0px;left:200.0px;");
		
		// txtNoLote
		txtNoLote = new TextField();
		txtNoLote.setCaption("Núm. de Lote");
		txtNoLote.setImmediate(false);
		txtNoLote.setWidth("140px");
		txtNoLote.setHeight("25px");
		absLGenerales.addComponent(txtNoLote, "top:73.0px;left:10.0px;");
		
		// txtSuperficie
		txtSuperficie = new TextField();
		txtSuperficie.setCaption("Superficie");
		txtSuperficie.setImmediate(true);
		txtSuperficie.setWidth("120px");
		txtSuperficie.setHeight("25px");
		absLGenerales.addComponent(txtSuperficie, "top:73.0px;left:170.0px;");
		
		// lblSuperficie
		lblSuperficie = new Label();
		lblSuperficie.setImmediate(false);
		lblSuperficie.setWidth("-1px");
		lblSuperficie.setHeight("-1px");
		lblSuperficie.setValue("ha");
		absLGenerales.addComponent(lblSuperficie, "top:77.0px;left:295.0px;");
		
		// cmbFAbast
		cmbFAbast = new ComboBox();
		cmbFAbast.setCaption("Fuente de Abastecimiento");
		cmbFAbast.setImmediate(false);
		cmbFAbast.setWidth("300px");
		cmbFAbast.setHeight("25px");
		absLGenerales.addComponent(cmbFAbast, "top:118.0px;left:10.0px;");
		
		// cmbTenencia
		cmbTenencia = new ComboBox();
		cmbTenencia.setCaption("Tenencia de la Tierra");
		cmbTenencia.setImmediate(false);
		cmbTenencia.setWidth("300px");
		cmbTenencia.setHeight("25px");
		absLGenerales.addComponent(cmbTenencia, "top:163.0px;left:10.0px;");
		
		return absLGenerales;
	}
	@AutoGenerated
	private Panel buildPanDetTecnicos() {
		// common part: create layout
		panDetTecnicos = new Panel();
		panDetTecnicos.setImmediate(false);
		panDetTecnicos.setWidth("801px");
		panDetTecnicos.setHeight("-1px");
		
		// verLDetTecnicos
		verLDetTecnicos = buildVerLDetTecnicos();
		panDetTecnicos.setContent(verLDetTecnicos);
		
		return panDetTecnicos;
	}
	@AutoGenerated
	private VerticalLayout buildVerLDetTecnicos() {
		// common part: create layout
		verLDetTecnicos = new VerticalLayout();
		verLDetTecnicos.setImmediate(false);
		verLDetTecnicos.setWidth("100.0%");
		verLDetTecnicos.setHeight("100.0%");
		verLDetTecnicos.setMargin(false);
		
		// absLDetTecnicos
		absLDetTecnicos = buildAbsLDetTecnicos();
		verLDetTecnicos.addComponent(absLDetTecnicos);
		
		// absLDetTecnicosUnidad
		absLDetTecnicosUnidad = buildAbsLDetTecnicosUnidad();
		verLDetTecnicos.addComponent(absLDetTecnicosUnidad);
		
		// absLDetTecnicosDistrito
		absLDetTecnicosDistrito = buildAbsLDetTecnicosDistrito();
		verLDetTecnicos.addComponent(absLDetTecnicosDistrito);
		
		return verLDetTecnicos;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLDetTecnicos() {
		// common part: create layout
		absLDetTecnicos = new AbsoluteLayout();
		absLDetTecnicos.setImmediate(false);
		absLDetTecnicos.setWidth("100.0%");
		absLDetTecnicos.setHeight("60px");
		
		// cmbOrgCuenca
		cmbOrgCuenca = new ComboBox();
		cmbOrgCuenca.setCaption("Organismo de Cuenca");
		cmbOrgCuenca.setImmediate(false);
		cmbOrgCuenca.setWidth("300px");
		cmbOrgCuenca.setHeight("25px");
		absLDetTecnicos.addComponent(cmbOrgCuenca, "top:28.0px;left:10.0px;");
		
		// optUnidadoDto
		optUnidadoDto = new OptionGroup();
		optUnidadoDto.setImmediate(true);
		optUnidadoDto.setWidth("-1px");
		optUnidadoDto.setHeight("40px");
		absLDetTecnicos.addComponent(optUnidadoDto, "top:14.0px;left:330.0px;");
		
		return absLDetTecnicos;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLDetTecnicosUnidad() {
		// common part: create layout
		absLDetTecnicosUnidad = new AbsoluteLayout();
		absLDetTecnicosUnidad.setImmediate(false);
		absLDetTecnicosUnidad.setWidth("100.0%");
		absLDetTecnicosUnidad.setHeight("55px");
		
		// txtUdeRiego
		txtUdeRiego = new TextField();
		txtUdeRiego.setCaption("Unidad de Riego");
		txtUdeRiego.setImmediate(false);
		txtUdeRiego.setWidth("440px");
		txtUdeRiego.setHeight("25px");
		absLDetTecnicosUnidad.addComponent(txtUdeRiego,
				"top:18.0px;left:10.0px;");
		
		return absLDetTecnicosUnidad;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLDetTecnicosDistrito() {
		// common part: create layout
		absLDetTecnicosDistrito = new AbsoluteLayout();
		absLDetTecnicosDistrito.setImmediate(false);
		absLDetTecnicosDistrito.setWidth("100.0%");
		absLDetTecnicosDistrito.setHeight("100px");
		
		// cmbDtoR
		cmbDtoR = new ComboBox();
		cmbDtoR.setCaption("Distrito de Riego");
		cmbDtoR.setImmediate(false);
		cmbDtoR.setWidth("110px");
		cmbDtoR.setHeight("25px");
		absLDetTecnicosDistrito
				.addComponent(cmbDtoR, "top:18.0px;left:10.0px;");
		
		// cmbModuloR
		cmbModuloR = new ComboBox();
		cmbModuloR.setCaption("Módulo de Riego");
		cmbModuloR.setImmediate(false);
		cmbModuloR.setWidth("650px");
		cmbModuloR.setHeight("25px");
		absLDetTecnicosDistrito.addComponent(cmbModuloR,
				"top:18.0px;left:140.0px;");
		
		// cmbSRL
		cmbSRL = new ComboBox();
		cmbSRL.setCaption("S.R.L.");
		cmbSRL.setImmediate(true);
		cmbSRL.setWidth("780px");
		cmbSRL.setHeight("25px");
		absLDetTecnicosDistrito.addComponent(cmbSRL, "top:63.0px;left:10.0px;");
		
		return absLDetTecnicosDistrito;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLPropiedadCoords() {
		// common part: create layout
		absLPropiedadCoords = new AbsoluteLayout();
		absLPropiedadCoords.setImmediate(false);
		absLPropiedadCoords.setWidth("801px");
		absLPropiedadCoords.setHeight("324px");
		
		// panPropiedad
		panPropiedad = buildPanPropiedad();
		absLPropiedadCoords.addComponent(panPropiedad, "top:0.0px;left:0.0px;");
		
		// panCoordenadas
		panCoordenadas = buildPanCoordenadas();
		absLPropiedadCoords.addComponent(panCoordenadas,
				"top:0.0px;right:0.0px;");
		
		return absLPropiedadCoords;
	}
	@AutoGenerated
	private Panel buildPanPropiedad() {
		// common part: create layout
		panPropiedad = new Panel();
		panPropiedad.setCaption("Propiedad de la Parcela");
		panPropiedad.setImmediate(false);
		panPropiedad.setWidth("521px");
		panPropiedad.setHeight("-1px");
		
		// verLPropiedad
		verLPropiedad = buildVerLPropiedad();
		panPropiedad.setContent(verLPropiedad);
		
		return panPropiedad;
	}
	@AutoGenerated
	private VerticalLayout buildVerLPropiedad() {
		// common part: create layout
		verLPropiedad = new VerticalLayout();
		verLPropiedad.setImmediate(false);
		verLPropiedad.setWidth("100.0%");
		verLPropiedad.setHeight("100.0%");
		verLPropiedad.setMargin(false);
		
		// absLPropiedad1
		absLPropiedad1 = buildAbsLPropiedad1();
		verLPropiedad.addComponent(absLPropiedad1);
		
		// absLPropiedadRentada
		absLPropiedadRentada = buildAbsLPropiedadRentada();
		verLPropiedad.addComponent(absLPropiedadRentada);
		
		// absLPropiedadRentadaParcial
		absLPropiedadRentadaParcial = buildAbsLPropiedadRentadaParcial();
		verLPropiedad.addComponent(absLPropiedadRentadaParcial);
		
		// absLPropiedad2
		absLPropiedad2 = new AbsoluteLayout();
		absLPropiedad2.setImmediate(false);
		absLPropiedad2.setWidth("100.0%");
		absLPropiedad2.setHeight("10px");
		verLPropiedad.addComponent(absLPropiedad2);
		
		return verLPropiedad;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLPropiedad1() {
		// common part: create layout
		absLPropiedad1 = new AbsoluteLayout();
		absLPropiedad1.setImmediate(false);
		absLPropiedad1.setWidth("100.0%");
		absLPropiedad1.setHeight("55px");
		
		// cmbPropiedad
		cmbPropiedad = new ComboBox();
		cmbPropiedad.setCaption("La parcela es:");
		cmbPropiedad.setImmediate(true);
		cmbPropiedad.setWidth("250px");
		cmbPropiedad.setHeight("25px");
		absLPropiedad1.addComponent(cmbPropiedad, "top:28.0px;left:10.0px;");
		
		return absLPropiedad1;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLPropiedadRentada() {
		// common part: create layout
		absLPropiedadRentada = new AbsoluteLayout();
		absLPropiedadRentada.setImmediate(false);
		absLPropiedadRentada.setWidth("100.0%");
		absLPropiedadRentada.setHeight("45px");
		
		// txtArrendatario
		txtArrendatario = new TextField();
		txtArrendatario.setCaption("Nombre del Arrendatario");
		txtArrendatario.setImmediate(false);
		txtArrendatario.setWidth("350px");
		txtArrendatario.setHeight("25px");
		absLPropiedadRentada.addComponent(txtArrendatario,
				"top:18.0px;left:10.0px;");
		
		// lblSuperficieArrendada
		lblSuperficieArrendada = new Label();
		lblSuperficieArrendada.setImmediate(false);
		lblSuperficieArrendada.setWidth("-1px");
		lblSuperficieArrendada.setHeight("-1px");
		lblSuperficieArrendada.setValue("ha");
		absLPropiedadRentada.addComponent(lblSuperficieArrendada,
				"top:22.0px;left:485.0px;");
		
		// txtSuperficieArrendada
		txtSuperficieArrendada = new TextField();
		txtSuperficieArrendada.setCaption("Superficie");
		txtSuperficieArrendada.setImmediate(true);
		txtSuperficieArrendada.setWidth("100px");
		txtSuperficieArrendada.setHeight("25px");
		absLPropiedadRentada.addComponent(txtSuperficieArrendada,
				"top:18.0px;left:380.0px;");
		
		return absLPropiedadRentada;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLPropiedadRentadaParcial() {
		// common part: create layout
		absLPropiedadRentadaParcial = new AbsoluteLayout();
		absLPropiedadRentadaParcial.setImmediate(false);
		absLPropiedadRentadaParcial.setWidth("100.0%");
		absLPropiedadRentadaParcial.setHeight("191px");
		
		// horLBotonesArrendatarios
		horLBotonesArrendatarios = buildHorLBotonesArrendatarios();
		absLPropiedadRentadaParcial.addComponent(horLBotonesArrendatarios,
				"top:10.0px;right:10.0px;");
		
		// tblArrendatarios
		tblArrendatarios = new Table();
		tblArrendatarios
				.setCaption("* Dar doble click sobre un elemento para modificarlo");
		tblArrendatarios.setImmediate(false);
		tblArrendatarios.setWidth("500px");
		tblArrendatarios.setHeight("130px");
		absLPropiedadRentadaParcial.addComponent(tblArrendatarios,
				"top:60.0px;left:10.0px;");
		
		return absLPropiedadRentadaParcial;
	}
	@AutoGenerated
	private HorizontalLayout buildHorLBotonesArrendatarios() {
		// common part: create layout
		horLBotonesArrendatarios = new HorizontalLayout();
		horLBotonesArrendatarios.setImmediate(false);
		horLBotonesArrendatarios.setWidth("-1px");
		horLBotonesArrendatarios.setHeight("-1px");
		horLBotonesArrendatarios.setMargin(false);
		horLBotonesArrendatarios.setSpacing(true);
		
		// btnAdd
		btnAdd = new Button();
		btnAdd.setCaption("Agregar");
		btnAdd.setImmediate(true);
		btnAdd.setWidth("-1px");
		btnAdd.setHeight("-1px");
		horLBotonesArrendatarios.addComponent(btnAdd);
		
		// btnCancel
		btnCancel = new Button();
		btnCancel.setCaption("Cancelar");
		btnCancel.setImmediate(true);
		btnCancel.setWidth("-1px");
		btnCancel.setHeight("-1px");
		horLBotonesArrendatarios.addComponent(btnCancel);
		
		return horLBotonesArrendatarios;
	}
	@AutoGenerated
	private Panel buildPanCoordenadas() {
		// common part: create layout
		panCoordenadas = new Panel();
		panCoordenadas.setCaption("Coordenadas Centrales UTM");
		panCoordenadas.setImmediate(false);
		panCoordenadas.setWidth("271px");
		panCoordenadas.setHeight("-1px");
		
		// verLCoordenadas
		verLCoordenadas = buildVerLCoordenadas();
		panCoordenadas.setContent(verLCoordenadas);
		
		return panCoordenadas;
	}
	@AutoGenerated
	private VerticalLayout buildVerLCoordenadas() {
		// common part: create layout
		verLCoordenadas = new VerticalLayout();
		verLCoordenadas.setImmediate(false);
		verLCoordenadas.setWidth("100.0%");
		verLCoordenadas.setHeight("-1px");
		verLCoordenadas.setMargin(false);
		
		// absLCoordenadas1
		absLCoordenadas1 = buildAbsLCoordenadas1();
		verLCoordenadas.addComponent(absLCoordenadas1);
		
		return verLCoordenadas;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLCoordenadas1() {
		// common part: create layout
		absLCoordenadas1 = new AbsoluteLayout();
		absLCoordenadas1.setImmediate(false);
		absLCoordenadas1.setWidth("100.0%");
		absLCoordenadas1.setHeight("110px");
		
		// txtCoordX
		txtCoordX = new TextField();
		txtCoordX.setCaption("Coordenada X");
		txtCoordX.setImmediate(false);
		txtCoordX.setWidth("250px");
		txtCoordX.setHeight("25px");
		absLCoordenadas1.addComponent(txtCoordX, "top:28.0px;left:10.0px;");
		
		// txtCoordY
		txtCoordY = new TextField();
		txtCoordY.setCaption("Coordenada Y");
		txtCoordY.setImmediate(false);
		txtCoordY.setWidth("250px");
		txtCoordY.setHeight("25px");
		absLCoordenadas1.addComponent(txtCoordY, "top:73.0px;left:10.0px;");
		
		return absLCoordenadas1;
	}
	@AutoGenerated
	private Panel buildPanObservaciones() {
		// common part: create layout
		panObservaciones = new Panel();
		panObservaciones.setCaption("Observaciones");
		panObservaciones.setImmediate(false);
		panObservaciones.setWidth("801px");
		panObservaciones.setHeight("-1px");
		
		// absLObservaciones
		absLObservaciones = buildAbsLObservaciones();
		panObservaciones.setContent(absLObservaciones);
		
		return panObservaciones;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLObservaciones() {
		// common part: create layout
		absLObservaciones = new AbsoluteLayout();
		absLObservaciones.setImmediate(false);
		absLObservaciones.setWidth("100.0%");
		absLObservaciones.setHeight("120px");
		
		// txtObservaciones
		txtObservaciones = new TextArea();
		txtObservaciones.setImmediate(false);
		txtObservaciones.setWidth("780px");
		txtObservaciones.setHeight("100px");
		absLObservaciones.addComponent(txtObservaciones,
				"top:10.0px;left:10.0px;");
		
		return absLObservaciones;
	}
	@AutoGenerated
	private AbsoluteLayout buildAbsLBotones() {
		// common part: create layout
		absLBotones = new AbsoluteLayout();
		absLBotones.setImmediate(false);
		absLBotones.setWidth("801px");
		absLBotones.setHeight("30px");
		
		// btnGuardar
		btnGuardar = new Button();
		btnGuardar.setCaption("Guardar");
		btnGuardar.setImmediate(true);
		btnGuardar.setWidth("-1px");
		btnGuardar.setHeight("-1px");
		absLBotones.addComponent(btnGuardar, "right:0.0px;bottom:0.0px;");
		
		// horLBotones
		horLBotones = buildHorLBotones();
		absLBotones.addComponent(horLBotones, "bottom:0.0px;left:0.0px;");
		
		return absLBotones;
	}
	@AutoGenerated
	private HorizontalLayout buildHorLBotones() {
		// common part: create layout
		horLBotones = new HorizontalLayout();
		horLBotones.setImmediate(false);
		horLBotones.setWidth("-1px");
		horLBotones.setHeight("-1px");
		horLBotones.setMargin(false);
		horLBotones.setSpacing(true);
		
		// btnNuevo
		btnNuevo = new Button();
		btnNuevo.setCaption("Agregar Nuevo");
		btnNuevo.setImmediate(true);
		btnNuevo.setWidth("-1px");
		btnNuevo.setHeight("-1px");
		horLBotones.addComponent(btnNuevo);
		
		// btnVolver
		btnVolver = new Button();
		btnVolver.setCaption("Volver");
		btnVolver.setImmediate(true);
		btnVolver.setWidth("-1px");
		btnVolver.setHeight("-1px");
		horLBotones.addComponent(btnVolver);
		
		return horLBotones;
	}
	
	//endregion
}